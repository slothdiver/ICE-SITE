<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>In Case of Emergency (ICE)</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#0f172a;color:#e5e7eb}
    .wrap{max-width:900px;margin:0 auto;padding:24px}
    .card{background:#111827;border-radius:10px;padding:20px;box-shadow:0 5px 20px #0007}
    h1{margin-top:0}
    label{display:block;margin:8px 0 4px}
    input,textarea,select{width:100%;padding:8px;border-radius:6px;border:1px solid #334155;background:#0b1220;color:#e5e7eb}
    button{margin-top:12px;padding:10px 14px;border:none;border-radius:6px;cursor:pointer}
    .btn-primary{background:#2563eb;color:#fff}
    .btn-danger{background:#b91c1c;color:#fff}
    .muted{color:#94a3b8;font-size:14px}
    .hidden{display:none}
  </style>
</head>
<body>
  <div id="gate" class="wrap">
    <div class="card">
      <h1>Enter password</h1>
      <p class="muted">Use view or edit password</p>
      <input id="gateInput" type="password" placeholder="Password" />
      <button id="gateBtn" class="btn-primary">Unlock</button>
      <p id="gateMsg" class="muted"></p>
    </div>
  </div>

  <div id="app" class="wrap hidden">
    <div class="card">
      <h1>In Case of Emergency (ICE)</h1>
      <form id="iceForm">
        <label>Full name<input id="fullName" /></label>
        <label>Date of birth<input id="dob" type="date" /></label>
        <label>Address<input id="address" /></label>
        <label>Phone number<input id="phone" /></label>
        <label>Email<input id="email" type="email" /></label>

        <h2>Emergency Contact</h2>
        <label>Contact name<input id="ecName" /></label>
        <label>Relationship<input id="ecRel" /></label>
        <label>Phone<input id="ecPhone" /></label>
        <label>Alternate phone<input id="ecAlt" /></label>

        <h2>Medical Information</h2>
        <label>Blood type<select id="blood"><option value="">Select</option><option>A+</option><option>A-</option><option>B+</option><option>B-</option><option>AB+</option><option>AB-</option><option>O+</option><option>O-</option><option>Unknown</option></select></label>
        <label>Allergies<textarea id="allergies"></textarea></label>
        <label>Medications<textarea id="meds"></textarea></label>
        <label>Medical conditions<textarea id="conditions"></textarea></label>
        <label>Primary care physician<input id="pcp" placeholder="Name, phone"/></label>
        <label>Specialist(s)<input id="specialists" placeholder="Name(s), phone(s)"/></label>
        <label>Past surgeries / history<textarea id="history"></textarea></label>

        <h2>Insurance & ID</h2>
        <label>Insurance provider<input id="insProvider"/></label>
        <label>Policy number<input id="policy"/></label>
        <label>ID / Driverâ€™s license<input id="dl"/></label>
        <label>Preferred hospital<input id="hospital"/></label>

        <h2>Directives & Other</h2>
        <label>Advance directive / DNR<input id="dnr"/></label>
        <label>Organ donor<select id="donor"><option value="">Select</option><option>Yes</option><option>No</option><option>Unknown</option></select></label>
        <label>Special needs<textarea id="needs"></textarea></label>
        <label>Pets / dependents<textarea id="pets"></textarea></label>
        <label>Notes<textarea id="notes"></textarea></label>
      </form>
      <button id="saveBtn" class="btn-primary">Save</button>
    </div>
  </div>

<script>
(function(){
  const VIEW_PASSWORD = "view123";
  const EDIT_PASSWORD = "edit123";
  const STORAGE_KEY = "ice_sheet";
  let canEdit = false;

  const gate = document.getElementById('gate');
  const app = document.getElementById('app');
  const gateInput = document.getElementById('gateInput');
  const gateBtn = document.getElementById('gateBtn');
  const gateMsg = document.getElementById('gateMsg');

  const saveBtn = document.getElementById('saveBtn');
  const ids = ['fullName','dob','address','phone','email','ecName','ecRel','ecPhone','ecAlt','blood','allergies','meds','conditions','pcp','specialists','history','insProvider','policy','dl','hospital','dnr','donor','needs','pets','notes'];
  const nodes = Object.fromEntries(ids.map(id=>[id,document.getElementById(id)]));

  function applyEditability(){
    ids.forEach(id=>{
      const el = nodes[id];
      if(!el) return;
      if(canEdit){ el.removeAttribute('disabled'); }
      else { el.setAttribute('disabled','disabled'); }
    });
    saveBtn.style.display = canEdit ? '' : 'none';
  }

  function unlock(){
    gate.classList.add('hidden');
    app.classList.remove('hidden');
    load();
    applyEditability();
  }

  gateBtn.addEventListener('click',()=>{
    const pw = gateInput.value.trim();
    if(pw===VIEW_PASSWORD){ canEdit=false; unlock(); }
    else if(pw===EDIT_PASSWORD){ canEdit=true; unlock(); }
    else { gateMsg.textContent = 'Incorrect password'; }
  });
  gateInput.addEventListener('keydown',e=>{ if(e.key==='Enter'){ gateBtn.click(); }});

  function save(){
    const data={}; ids.forEach(id=>data[id]=nodes[id].value);
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  }
  function load(){
    const raw = localStorage.getItem(STORAGE_KEY); if(!raw) return;
    try{
      const data = JSON.parse(raw);
      ids.forEach(id=>{ if(data[id]) nodes[id].value=data[id]; });
    }catch(e){}
  }
  saveBtn.addEventListener('click',()=>{ if(canEdit){ save(); alert('Saved'); } });
})();
</script>
</body>
</html>
